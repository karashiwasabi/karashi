<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KARASHI</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/table_layout.css">
    <link rel="stylesheet" href="/static/css/inout.css">
</head>
<body>

<header id="main-header">
    <button id="inOutViewBtn" class="btn">入庫・出庫</button>
    <button id="masterEditViewBtn" class="btn">マスター</button>
    <button id="datBtn" class="btn">納品・返品</button>
    <button id="usageBtn" class="btn">処方 (USAGE) ファイル選択</button>
    <button id="exportClientsBtn" class="btn">得意先エクスポート</button>
    <button id="importClientsBtn" class="btn">得意先インポート</button>
    <button id="exportProductsBtn" class="btn">製品エクスポート</button>
    <button id="importProductsBtn" class="btn">製品インポート</button>
    <button id="updateJcshmsBtn" class="btn">JCSHMSマスター更新</button>
    <button id="reprocessBtn" class="btn">仮登録を再計算</button>
    <button id="aggregationBtn" class="btn">集計</button>
    <button id="inventoryBtn" class="btn">棚卸</button>
    <button id="sampleBtn" class="btn">サンプル</button>
    <input type="file" id="importClientsInput" style="display:none;" accept=".csv">
    <input type="file" id="importProductsInput" style="display:none;" accept=".csv">
</header>

<main>
    <div id="upload-view" class="hidden">
        <input type="file" id="datFileInput" multiple style="display:none;">
        <input type="file" id="usageFileInput" style="display:none;">
        <div id="upload-output-container" class="table-container">
        </div>
     </div>

    <div id="in-out-view" class="hidden inout-view-container">
        <div id="inout-header-controls" class="inout-header-controls">
            <div class="field-group">
                <label for="in-out-date">日付</label>
                <input type="date" id="in-out-date">
            </div>
            <div class="field-group">
                <label for="in-out-type">種別</label>
                <select id="in-out-type"><option>入庫</option><option>出庫</option></select>
            </div>
            <div class="field-group">
                <label for="in-out-client">得意先</label>
                <select id="in-out-client"></select>
            </div>
            <div class="field-group">
                <label for="in-out-receipt">伝票番号</label>
                 <select id="in-out-receipt"></select>
            </div>
            <div class="buttons-group">
                <button id="saveBtn" class="btn">保存</button>
                <button id="deleteBtn" class="btn">伝票削除</button>
            </div>
        </div>

        <div class="inout-details-header">
            <button id="addRowBtn" class="btn">明細を追加</button>
        </div>

        <div id="inout-details-container" class="table-container">
            <table id="inout-details-table" class="data-table">
                <tbody>
                </tbody>
            </table>
        </div>
    </div>

    <div id="master-edit-view" class="hidden">
        <div class="in-out-header">
            <div></div>
            <div>
                <button id="addMasterRowBtn" class="btn">新規行を追加</button>
                <button id="refreshMastersBtn" class="btn">一覧を更新</button>
             </div>
        </div>
        <div class="table-container">
             <table id="master-edit-table" class="data-table">
                <thead>
                </thead>
                <tbody>
                </tbody>
             </table>
        </div>
    </div>

    <div id="aggregation-view" class="hidden">
        <div class="filter-container">
            <div class="filter-group">
                <label for="startDate">開始日</label>
                <input type="date" id="startDate">
            </div>
            <div class="filter-group">
                <label for="endDate">終了日</label>
                <input type="date" id="endDate">
            </div>
            <div class="filter-group">
                <label for="kanaName">カナ名</label>
                <input type="text" id="kanaName" placeholder="（部分一致）">
            </div>
            <div class="filter-group">
                <label>薬の種類</label>
                <div class="filter-group-checkbox">
                    <label><input type="checkbox" name="drugType" value="poison">  毒薬</label>
                    <label><input type="checkbox" name="drugType" value="deleterious"> 劇薬</label>
                    <label><input type="checkbox" name="drugType" value="narcotic"> 麻薬</label>
                    <label><input type="checkbox" name="drugType" value="psychotropic1"> 向精神薬(1)</label>
                    <label><input type="checkbox" name="drugType" value="psychotropic2"> 向精神薬(2)</label>
                     <label><input type="checkbox" name="drugType" value="psychotropic3"> 向精神薬(3)</label>
                    <label><input type="checkbox" name="drugType" value="stimulant"> 覚醒剤</label>
                    <label><input type="checkbox" name="drugType" value="stimulant_raw"> 覚醒剤原料</label>
                </div>
            </div>
            <div class="filter-group">
                <label for="reorder-coefficient">安全係数</label>
                <input type="number" id="reorder-coefficient" value="1.5" step="0.1" style="width: 100px;">
            </div>
            <div class="filter-group">
                <label style="visibility: hidden;">ダミー</label>
                <label class="no-movement-label"><input type="checkbox" id="reorder-needed-filter"> 要発注のみ表示</label>
            </div>
            <div class="filter-group-buttons">
                <button id="run-aggregation-btn" class="btn">集計実行</button>
                <button id="print-aggregation-btn" class="btn">印刷</button>
            </div>
        </div>
        <div id="aggregation-output-container" class="table-container">
        </div>
    </div>

    <div id="inventory-view" class="hidden">
        <input type="file" id="inventoryFileInput" style="display:none;">
        <div id="inventory-output-container" class="table-container">
        </div>
    </div>

    <div id="sample-view" class="hidden">
    </div>

    <div id="search-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>薬品検索</h2>
                <button id="closeModalBtn" class="close-button">&times;</button>
             </div>
              <div style="margin-bottom: 10px; display: flex; gap: 5px;">
                <input type="text" id="product-search-input" placeholder="製品名またはカナ名（2文字以上）" style="flex-grow: 1; padding: 5px;">
                <button id="product-search-btn" class="btn">検索</button>
            </div>
            <div class="modal-body" id="search-results-container">
                <table class="data-table" id="search-results-table">
                     <thead>
                        <tr>
                            <th>製品名</th>
                            <th>メーカー</th>
                             <th>包装</th>
                            <th>YJコード</th>
                             <th>JANコード</th>
                             <th>選択</th>
                        </tr>
                    </thead>
                     <tbody>
                    </tbody>
                </table>
            </div>
         </div>
    </div>
</main>

<div id="loading-overlay" class="hidden">
    <div class="spinner"></div>
    <p>処理中...</p>
</div>

<div id="notification-box" class="hidden"></div>

<button id="back-to-top" class="hidden" title="一番上へ戻る">&uarr;</button>

<script type="module" src="/static/js/app.js"></script>

</body>
</html>